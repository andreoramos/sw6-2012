<?xml version="1.0" encoding="utf-8"?><!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_1.dtd'><nta><declaration>// Place global declarations here.
const int P = 3;
typedef int[0, P-1] id_person;

const int F = 3;
typedef int[0, F-1] id_floor;

const int L = 2;
typedef int[0, L-1] id_lift;

chan enter[L][P][F], exit[L][P][F];
chan reqFloor[L][F];
broadcast chan arrived[L][F];
chan callElevatorToFloor[L][F];



</declaration><template><name x="5" y="5">Elevator</name><parameter>const id_lift id</parameter><declaration>// Place local declarations here.
clock time;

int[0,P] persons = 0;
id_floor floor = 0;

id_floor list[F+1];
int[0,F] len = 0;

// Put an element at the end of the queue
void enqueue(id_floor element)
{
        list[len++] = element;
}

// Remove the front element of the queue
void dequeue()
{
        int i = 0;
        len -= 1;
        while (i &lt; len)
        {
                list[i] = list[i + 1];
                i++;
        }
        list[i] = 0;
}

// Returns the front element of the queue
id_floor front()
{
   return list[0];
}

// Returns the last element of the queue
id_floor tail()
{
   return list[len - 1];
}</declaration><location id="id0" x="-1104" y="-376"><name x="-1128" y="-424">Stopped</name><label kind="invariant" x="-1128" y="-408">time &lt;= 50</label></location><location id="id1" x="-1544" y="-160"><name x="-1576" y="-144">Door_closed</name><label kind="invariant" x="-1576" y="-128">time &lt;= 25</label></location><location id="id2" x="-1544" y="-376"><name x="-1536" y="-360">Door_open</name><label kind="invariant" x="-1536" y="-344">time &lt;= 20</label></location><location id="id3" x="-1104" y="-160"><name x="-1128" y="-144">Moving</name><label kind="invariant" x="-1128" y="-128">time &lt;= 45</label></location><init ref="id2"/><transition><source ref="id3"/><target ref="id0"/><label kind="guard" x="-1144" y="-280">floor == front()</label></transition><transition><source ref="id2"/><target ref="id2"/><label kind="select" x="-1768" y="-544">newFloor : id_floor</label><label kind="guard" x="-1768" y="-528">persons == 0 &amp;&amp; len == 0</label><label kind="synchronisation" x="-1768" y="-514">callElevatorToFloor[id][newFloor]?</label><label kind="assignment" x="-1768" y="-499">enqueue(newFloor)</label><nail x="-1600" y="-496"/><nail x="-1672" y="-440"/></transition><transition><source ref="id1"/><target ref="id3"/><label kind="guard" x="-1392" y="-160">len &gt;= persons</label></transition><transition><source ref="id2"/><target ref="id1"/><label kind="guard" x="-1688" y="-280">persons &gt; 0 || len &gt; 0</label><label kind="assignment" x="-1688" y="-264">time = 0</label></transition><transition><source ref="id2"/><target ref="id2"/><label kind="select" x="-1552" y="-488">person : id_person</label><label kind="guard" x="-1552" y="-472">persons &gt; 0</label><label kind="synchronisation" x="-1552" y="-456">exit[id][person][floor]?</label><label kind="assignment" x="-1552" y="-440">persons--</label><nail x="-1512" y="-416"/><nail x="-1544" y="-416"/></transition><transition><source ref="id3"/><target ref="id0"/><label kind="guard" x="-1248" y="-280">floor &gt; front()</label><label kind="assignment" x="-1248" y="-264">floor--</label><nail x="-1160" y="-264"/></transition><transition><source ref="id3"/><target ref="id0"/><label kind="guard" x="-1040" y="-280">floor &lt; front()</label><label kind="assignment" x="-1040" y="-264">floor++</label><nail x="-1048" y="-264"/></transition><transition><source ref="id0"/><target ref="id2"/><label kind="guard" x="-1392" y="-336">floor == front()</label><label kind="synchronisation" x="-1392" y="-320">arrived[id][floor]!</label><label kind="assignment" x="-1392" y="-304">dequeue(), time = 0</label><nail x="-1272" y="-336"/><nail x="-1384" y="-336"/></transition><transition><source ref="id1"/><target ref="id1"/><label kind="select" x="-1736" y="-208">newFloor : id_floor</label><label kind="synchronisation" x="-1736" y="-192">reqFloor[id][newFloor]?</label><label kind="assignment" x="-1736" y="-176">enqueue(newFloor)</label><nail x="-1592" y="-160"/><nail x="-1592" y="-192"/></transition><transition><source ref="id2"/><target ref="id2"/><label kind="select" x="-1760" y="-400">person : id_person</label><label kind="guard" x="-1760" y="-384">persons &lt;= 4 &amp;&amp; len == 0</label><label kind="synchronisation" x="-1760" y="-368">enter[id][person][floor]?</label><label kind="assignment" x="-1760" y="-350">persons++</label><nail x="-1592" y="-376"/><nail x="-1592" y="-344"/></transition><transition><source ref="id0"/><target ref="id2"/><label kind="guard" x="-1392" y="-456">floor != front()</label><label kind="assignment" x="-1392" y="-440">time = 0</label><nail x="-1272" y="-416"/><nail x="-1384" y="-416"/></transition></template><template><name>Person</name><parameter>const id_person id</parameter><declaration>clock time;

id_floor floor = 0;
id_lift myLift;

</declaration><location id="id4" x="-912" y="-128"><name x="-928" y="-112">Angry</name></location><location id="id5" x="-416" y="-304"><name x="-440" y="-336">Exiting</name><committed/></location><location id="id6" x="-416" y="-128"><name x="-456" y="-120">RequestedFloor</name></location><location id="id7" x="-912" y="-304"><name x="-1000" y="-312">Wating</name><label kind="invariant" x="-1000" y="-296">time &lt;= 1000</label></location><location id="id8" x="-664" y="-128"><name x="-688" y="-112">Entered</name></location><location id="id9" x="-664" y="-304"><name x="-688" y="-336">OnFloor</name></location><init ref="id9"/><transition><source ref="id4"/><target ref="id9"/><label kind="select" x="-864" y="-168">newFloor : id_floor</label><label kind="assignment" x="-864" y="-152">floor = newFloor, time = 0</label><label kind="comments">The person is mad and takes the stairs!</label></transition><transition><source ref="id7"/><target ref="id4"/><label kind="guard" x="-1000" y="-224">time == 1000</label></transition><transition><source ref="id6"/><target ref="id5"/><label kind="synchronisation" x="-408" y="-240">arrived[myLift][floor]?</label></transition><transition><source ref="id7"/><target ref="id9"/><label kind="select" x="-816" y="-424">lift : id_lift</label><label kind="synchronisation" x="-816" y="-408">arrived[lift][floor]?</label><label kind="assignment" x="-816" y="-392">time = 0</label><nail x="-784" y="-376"/></transition><transition><source ref="id9"/><target ref="id8"/><label kind="select" x="-648" y="-248">l : id_lift</label><label kind="synchronisation" x="-648" y="-232">enter[l][id][floor]!</label><label kind="assignment" x="-648" y="-216">myLift = l</label></transition><transition><source ref="id5"/><target ref="id9"/><label kind="synchronisation" x="-608" y="-344">exit[myLift][id][floor]!</label><label kind="assignment" x="-608" y="-328">time = 0</label></transition><transition><source ref="id8"/><target ref="id6"/><label kind="select" x="-616" y="-126">newFloor : id_floor</label><label kind="guard" x="-616" y="-111">floor != newFloor</label><label kind="synchronisation" x="-616" y="-96">reqFloor[myLift][newFloor]!</label><label kind="assignment" x="-616" y="-81">floor = newFloor</label></transition><transition><source ref="id9"/><target ref="id7"/><label kind="select" x="-872" y="-304">lift : id_lift</label><label kind="synchronisation" x="-872" y="-288">callElevatorToFloor[lift][floor]!</label></transition></template><system>system Person, Elevator;</system></nta>